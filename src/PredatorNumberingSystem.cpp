#include "PredatorNumberingSystem.h"

#define NO_ASSOCIATED_NUMBER -1
#define ASSOCIATED_NUMBERS_LEN 1549
const int16_t associated_numbers[] PROGMEM = { 0000, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 5100, 1211, 6100, 1221, 7100, 3200, 8100, 1400, 9100, 1213, 4200, 1223, 1311, 1214, 2213, 5200, 1500, 1215, 1331, 1225, 6200, 1312, 2311, 1226, 1322, 2321, 2216, 1411, 2331, 1218, 1313, 1421, 3311, 1323, 2322, 1431, 1333, 2332, 3331, 1441, 2313, 3312, 1324, 1412, 2411, 1334, 1511, 1422, 2421, 2314, 3313, 1521, 2431, 3323, 1335, 1442, 1531, 1316, 2315, 1413, 2412, 1541, 3324, 1423, 2422, 3421, 1551, 1433, 2432, 1611, 2326, 1512, 2511, 3441, 3335, 1621, 1522, 2521, 4411, 1424, 2423, 1631, 2531, 1434, 2433, 3432, 1542, 1641, 2443, 3442, 4441, 1552, 2551, 1651, 4412, 1425, 1711, 2512, 3511, 1661, 2434, 1523, 2522, 1721, 2444, 1612, 2611, 2532, 3531, 3414, 1731, 1622, 2621, 3541, 4423, 1436, 1553, 1741, 2631, 1446, 2445, 1514, 2513, 1642, 1751, 3415, 1524, 1811, 3522, 1652, 2651, 1761, 2533, 3532, 4531, 1821, 2661, 2543, 1771, 4541, 2417, 1613, 2612, 1831, 4551, 1712, 2711, 1623, 2622, 3621, 5511, 1841, 1722, 2721, 2632, 3631, 1535, 2534, 3533, 1851, 2731, 3641, 1911, 3543, 4542, 1653, 1742, 1861, 3553, 4552, 5551, 1921, 2662, 1752, 2751, 1871, 1526, 1614, 2613, 3612, 1931, 2761, 2535, 1881, 2623, 3622, 4621, 1772, 2771, 1941, 2633, 1812, 2811, 3554, 1713, 2712, 3711, 3642, 1951, 1822, 2821, 1723, 2722, 3721, 4651, 5523, 1537, 1961, 2831, 2732, 3731, 1547, 2546, 1615, 2614, 1842, 1971, 3741, 3555, 1625, 2624, 3623, 1753, 1852, 2851, 1981, 2634, 3633, 4632, 1763, 2762, 1862, 2861, 3643, 1991, 5641, 1773, 2772, 3771, 1872, 2871, 5651, 2557, 1912, 2911, 3712, 4711, 1882, 2881, 1616, 1724, 2723, 1922, 2921, 6611, 1813, 2812, 3811, 2733, 3732, 4731, 1932, 2931, 1823, 2822, 3821, 3742, 4741, 2645, 3644, 1942, 2941, 2832, 3831, 4751, 3654, 4653, 5652, 1764, 1952, 2951, 3841, 4663, 5662, 6661, 1774, 2773, 1853, 1962, 2961, 6612, 1627, 1715, 2714, 3713, 1863, 2862, 1972, 2971, 1725, 2724, 3723, 4722, 1873, 2872, 3871, 1982, 2981, 3733, 4732, 5731, 1883, 2882, 3881, 2744, 1992, 2991, 5741, 4664, 1814, 2813, 3812, 4811, 4752, 1913, 2912, 3911, 1824, 2823, 3822, 4821, 5761, 6623, 1923, 2922, 3921, 2833, 3832, 4831, 1648, 2647, 1716, 1933, 2932, 3931, 3842, 4841, 3656, 1726, 2725, 3724, 1943, 2942, 3941, 4851, 1736, 2735, 3734, 4733, 1864, 1953, 2952, 3951, 2745, 3744, 4743, 5742, 1874, 2873, 1963, 2962, 3961, 4753, 5752, 6751, 1884, 2883, 3882, 1973, 2972, 3971, 6761, 2658, 1815, 2814, 3813, 4812, 1983, 2982, 3981, 1717, 1825, 2824, 3823, 4822, 5821, 1993, 2992, 3991, 1835, 2834, 3833, 4832, 5831, 1737, 1914, 2913, 3912, 4911, 3843, 4842, 5841, 2746, 3745, 1924, 2923, 3922, 4921, 4852, 5851, 3755, 4754, 5753, 1934, 2933, 3932, 4931, 5861, 4764, 5763, 6762, 1875, 1944, 2943, 3942, 4941, 5773, 6772, 7771, 1885, 2884, 1954, 2953, 3952, 4951, 7712, 1728, 1816, 2815, 3814, 1964, 2963, 3962, 4961, 2737, 1826, 2825, 3824, 4823, 1974, 2973, 3972, 4971, 1836, 2835, 3834, 4833, 5832, 1984, 2983, 3982, 4981, 2845, 3844, 4843, 5842, 6841, 1994, 2993, 3992, 4991, 3854, 4853, 5852, 6851, 5774, 1915, 2914, 3913, 4912, 5911, 5862, 6861, 6714, 7713, 1925, 2924, 3923, 4922, 5921, 6871, 7723, 1739, 1886, 1935, 2934, 3933, 4932, 5931, 1749, 2748, 1817, 2816, 1945, 2944, 3943, 4942, 5941, 3757, 1827, 2826, 3825, 1955, 2954, 3953, 4952, 5951, 1837, 2836, 3835, 4834, 1965, 2964, 3963, 4962, 5961, 2846, 3845, 4844, 5843, 1975, 2974, 3973, 4972, 5971, 3855, 4854, 5853, 6852, 1985, 2984, 3983, 4982, 5981, 4864, 5863, 6862, 7861, 1995, 2994, 3993, 4992, 5991, 5873, 6872, 7871, 2759, 1916, 2915, 3914, 4913, 5912, 6911, 7881, 3768, 1818, 1926, 2925, 3924, 4923, 5922, 6921, 8811, 1828, 2827, 1936, 2935, 3934, 4933, 5932, 6931, 1838, 2837, 3836, 1946, 2945, 3944, 4943, 5942, 6941, 2847, 3846, 4845, 1956, 2955, 3954, 4953, 5952, 6951, 3856, 4855, 5854, 1966, 2965, 3964, 4963, 5962, 6961, 4865, 5864, 6863, 1976, 2975, 3974, 4973, 5972, 6971, 5874, 6873, 7872, 1986, 2985, 3984, 4983, 5982, 6981, 6883, 7882, 8881, 1996, 2995, 3994, 4993, 5992, 6991, 7813, 8812, 1829, 1917, 2916, 3915, 4914, 5913, 6912, 7911, 1839, 2838, 1927, 2926, 3925, 4924, 5923, 6922, 7921, 2848, 3847, 1937, 2936, 3935, 4934, 5933, 6932, 7931, 3857, 4856, 1947, 2946, 3945, 4944, 5943, 6942, 7941, 4866, 5865, 1957, 2956, 3955, 4954, 5953, 6952, 7951, 5875, 6874, 1967, 2966, 3965, 4964, 5963, 6962, 7961, 6884, 7883, 1977, 2976, 3975, 4974, 5973, 6972, 7971, 7814, 8813, 1987, 2986, 3985, 4984, 5983, 6982, 7981, 8823, 9822, 1997, 2996, 3995, 4994, 5993, 6992, 7991, 9832, 2849, 1918, 2917, 3916, 4915, 5914, 6913, 7912, 8911, 3858, 1928, 2927, 3926, 4925, 5924, 6923, 7922, 8921, 4867, 1938, 2937, 3936, 4935, 5934, 6933, 7932, 8931, 5876, 1948, 2947, 3946, 4945, 5944, 6943, 7942, 8941, 6885, 1958, 2957, 3956, 4955, 5954, 6953, 7952, 8951, 7815, 1968, 2967, 3966, 4965, 5964, 6963, 7962, 8961, 8824, 1978, 2977, 3976, 4975, 5974, 6973, 7972, 8971, 9833, 1988, 2987, 3986, 4985, 5984, 6983, 7982, 8981, -1, 1998, 2997, 3996, 4995, 5994, 6993, 7992, 8991, 3869, 1919, 2918, 3917, 4916, 5915, 6914, 7913, 8912, 9911, 1929, 2928, 3927, 4926, 5925, 6924, 7923, 8922, 9921, 1939, 2938, 3937, 4936, 5935, 6934, 7933, 8932, 9931, 1949, 2948, 3947, 4946, 5945, 6944, 7943, 8942, 9941, 1959, 2958, 3957, 4956, 5955, 6954, 7953, 8952, 9951, 1969, 2968, 3967, 4966, 5965, 6964, 7963, 8962, 9961, 1979, 2978, 3977, 4976, 5975, 6974, 7973, 8972, 9971, 1989, 2988, 3987, 4986, 5985, 6984, 7983, 8982, 9981, 1999, 2998, 3997, 4996, 5995, 6994, 7993, 8992, 9991, 5888, 2919, 3918, 4917, 5916, 6915, 7914, 8913, 9912, 6818, 2929, 3928, 4927, 5926, 6925, 7924, 8923, 9922, 7827, 2939, 3938, 4937, 5936, 6935, 7934, 8933, 9932, 8836, 2949, 3948, 4947, 5946, 6945, 7944, 8943, 9942, 9845, 2959, 3958, 4957, 5956, 6955, 7954, 8953, 9952, -1, 2969, 3968, 4967, 5966, 6965, 7964, 8963, 9962, -1, 2979, 3978, 4977, 5976, 6975, 7974, 8973, 9972, -1, 2989, 3988, 4987, 5986, 6985, 7984, 8983, 9982, 5899, 2999, 3998, 4997, 5996, 6995, 7994, 8993, 9992, 6829, 7828, 3919, 4918, 5917, 6916, 7915, 8914, 9913, 7838, 8837, 3929, 4928, 5927, 6926, 7925, 8924, 9923, 8847, 9846, 3939, 4938, 5937, 6936, 7935, 8934, 9933, 9856, -1, 3949, 4948, 5947, 6946, 7945, 8944, 9943, -1, -1, 3959, 4958, 5957, 6956, 7955, 8954, 9953, -1, -1, 3969, 4968, 5967, 6966, 7965, 8964, 9963, -1, -1, 3979, 4978, 5977, 6976, 7975, 8974, 9973, -1, -1, 3989, 4988, 5987, 6986, 7985, 8984, 9983, -1, 7839, 3999, 4998, 5997, 6996, 7995, 8994, 9993, 7849, 8848, 9847, 4919, 5918, 6917, 7916, 8915, 9914, 8858, 9857, -1, 4929, 5928, 6927, 7926, 8925, 9924, 9867, -1, -1, 4939, 5938, 6937, 7936, 8935, 9934, -1, -1, -1, 4949, 5948, 6947, 7946, 8945, 9944, -1, -1, -1, 4959, 5958, 6957, 7956, 8955, 9954, -1, -1, -1, 4969, 5968, 6967, 7966, 8965, 9964, -1, -1, -1, 4979, 5978, 6977, 7976, 8975, 9974, -1, -1, 8849, 4989, 5988, 6987, 7986, 8985, 9984, -1, 8859, 9858, 4999, 5998, 6997, 7996, 8995, 9994, 8869, 9868, -1, -1, 5919, 6918, 7917, 8916, 9915, 9878, -1, -1, -1, 5929, 6928, 7927, 8926, 9925, -1, -1, -1, -1, 5939, 6938, 7937, 8936, 9935, -1, -1, -1, -1, 5949, 6948, 7947, 8946, 9945, -1, -1, -1, -1, 5959, 6958, 7957, 8956, 9955, -1, -1, -1, -1, 5969, 6968, 7967, 8966, 9965, -1, -1, -1, 9859, 5979, 6978, 7977, 8976, 9975, -1, -1, 9869, -1, 5989, 6988, 7987, 8986, 9985, -1, 9879, -1, -1, 5999, 6998, 7997, 8996, 9995, 9889, -1, -1, -1, -1, 6919, 7918, 8917, 9916, -1, -1, -1, -1, -1, 6929, 7928, 8927, 9926, -1, -1, -1, -1, -1, 6939, 7938, 8937, 9936, -1, -1, -1, -1, -1, 6949, 7948, 8947, 9946, -1, -1, -1, -1, -1, 6959, 7958, 8957, 9956, -1, -1, -1, -1, -1, 6969, 7968, 8967, 9966, -1, -1, -1, -1, -1, 6979, 7978, 8977, 9976, -1, -1, -1, -1, -1, 6989, 7988, 8987, 9986, -1, -1, -1, -1, -1, 6999, 7998, 8997, 9996, -1, -1, -1, -1, -1, -1, 7919, 8918, 9917, -1, -1, -1, -1, -1, -1, 7929, 8928, 9927, -1, -1, -1, -1, -1, -1, 7939, 8938, 9937, -1, -1, -1, -1, -1, -1, 7949, 8948, 9947, -1, -1, -1, -1, -1, -1, 7959, 8958, 9957, -1, -1, -1, -1, -1, -1, 7969, 8968, 9967, -1, -1, -1, -1, -1, -1, 7979, 8978, 9977, -1, -1, -1, -1, -1, -1, 7989, 8988, 9987, -1, -1, -1, -1, -1, -1, 7999, 8998, 9997, -1, -1, -1, -1, -1, -1, -1, 8919, 9918, -1, -1, -1, -1, -1, -1, -1, 8929, 9928, -1, -1, -1, -1, -1, -1, -1, 8939, 9938, -1, -1, -1, -1, -1, -1, -1, 8949, 9948, -1, -1, -1, -1, -1, -1, -1, 8959, 9958, -1, -1, -1, -1, -1, -1, -1, 8969, 9968, -1, -1, -1, -1, -1, -1, -1, 8979, 9978, -1, -1, -1, -1, -1, -1, -1, 8989, 9988, -1, -1, -1, -1, -1, -1, -1, 8999, 9998, -1, -1, -1, -1, -1, -1, -1, -1, 9919, -1, -1, -1, -1, -1, -1, -1, -1, 9929, -1, -1, -1, -1, -1, -1, -1, -1, 9939, -1, -1, -1, -1, -1, -1, -1, -1, 9949, -1, -1, -1, -1, -1, -1, -1, -1, 9959, -1, -1, -1, -1, -1, -1, -1, -1, 9969, -1, -1, -1, -1, -1, -1, -1, -1, 9979, -1, -1, -1, -1, -1, -1, -1, -1, 9989, -1, -1, -1, -1, -1, -1, -1, -1, 9999 };

uint16_t PredatorNumberingSystem::numberingToBaseTen(uint16_t number) {
    // in order to get the value we need to know each digit
    uint8_t digits[4];
    for (int8_t n = 3; n >= 0; n--) {
        digits[n] = number % 10;
        number /= 10;
    }

    return (1)*(digits[0]) + (digits[0])*(digits[1]*digits[1]) + (digits[1])*(digits[2]) + (digits[1]*digits[1])*(digits[3]);
}

uint16_t PredatorNumberingSystem::maxNumberRepresented() {
    return ASSOCIATED_NUMBERS_LEN-1;
}

uint16_t PredatorNumberingSystem::minNumberRepresented() {
    return 0;
}

uint16_t PredatorNumberingSystem::baseTenToNumbering(uint16_t from) {
#ifdef __EXCEPTIONS
    if (from > this->maxNumberRepresented()) throw std::invalid_argument("Max value represented in this 4-digit numeric representation is " + std::to_string(this->maxNumberRepresented()));
#endif

    return associated_numbers[from];
}

std::vector<uint16_t> PredatorNumberingSystem::getDigits(uint16_t value, uint8_t num_digits) {
#ifdef __EXCEPTIONS
    if (num_digits != 4) throw std::invalid_argument("This library is meant to be used with a 4-digit display");
#endif

    uint16_t base_ten = numberingToBaseTen(value);
    std::vector<uint16_t> r;
    for (int8_t n = 3; n >= 0; n--) {
        r.insert(r.begin(), base_ten % 10); // as we're iterating the other way we have to insert it on the front
        base_ten /= 10;
    }
    return r;
}